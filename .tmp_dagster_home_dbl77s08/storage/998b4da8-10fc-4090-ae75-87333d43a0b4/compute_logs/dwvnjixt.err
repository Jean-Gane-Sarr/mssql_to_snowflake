[32m2026-02-26 12:04:22 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - 2504561 - LOGS_CAPTURED - Started capturing logs in process (pid: 2504561).
[32m2026-02-26 12:04:22 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - 2504561 - GCM_Retour_Donnees_OLGA - STEP_START - Started execution of step "GCM_Retour_Donnees_OLGA".
[32m2026-02-26 12:04:22 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - 
================================================================================
[32m2026-02-26 12:04:22 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üöÄ PIPELINE MSSQL ‚Üí SNOWFLAKE
[32m2026-02-26 12:04:22 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üì§‚û°Ô∏è‚ùÑÔ∏è  M√©thode: BCP + COPY INTO
[32m2026-02-26 12:04:22 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ================================================================================

[32m2026-02-26 12:04:22 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ================================================================================
[32m2026-02-26 12:04:22 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üì§ Export BCP depuis SQL Server pour la table GCM_Retour_Donnees_OLGA
[32m2026-02-26 12:04:22 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ================================================================================
[32m2026-02-26 12:04:22 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üóëÔ∏è  Fichier existant supprim√©: /tmp/mssql_export.csv
2026-02-26 12:04:22,656 - INFO - üîß BCPExporter initialis√©:
2026-02-26 12:04:22,656 - INFO -    Mode: Natif
2026-02-26 12:04:22,656 - INFO -    BCP: bcp
[32m2026-02-26 12:04:22 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üîÑ Ex√©cution BCP...
2026-02-26 12:04:22,673 - INFO - üíª Mode natif
2026-02-26 12:04:22,673 - INFO - üîÑ Commande BCP: bcp SELECT TOP 10000000 * FROM GCM_Retour_Donnees_OLGA WITH (NOLOCK) queryout /tmp/mssql_export.csv -c -C 65001 -t | -r 
 -S *** -d *** -U *** -P ***
2026-02-26 12:07:44,566 - INFO - ‚úÖ Export BCP r√©ussi: Dur√©e 201.89s, Taille 152.52 MB
[32m2026-02-26 12:07:44 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ‚úÖ Export BCP termin√© en 201.89s
[32m2026-02-26 12:07:44 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA -    Temps BCP: 201.89s
[32m2026-02-26 12:07:44 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA -    Fichier: /tmp/mssql_export.csv
[32m2026-02-26 12:07:44 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA -    Taille: 152.52 MB
[32m2026-02-26 12:07:44 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ================================================================================
[32m2026-02-26 12:07:44 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üîß Setup Snowflake
[32m2026-02-26 12:07:44 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ================================================================================
2026-02-26 12:07:44,757 - INFO - Snowflake Connector for Python Version: 4.3.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-02-26 12:07:44,760 - INFO - Connecting to GLOBAL Snowflake domain
[32m2026-02-26 12:07:48 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üîß Cr√©ation du file format CSV...
[32m2026-02-26 12:07:48 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ‚úÖ File format mssql_csv_file_format cr√©√©
[32m2026-02-26 12:07:48 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üîß Cr√©ation du stage...
[32m2026-02-26 12:07:48 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ‚úÖ Stage MSSQL_DIRECT_STAGE cr√©√©
[32m2026-02-26 12:07:48 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üîß Cr√©ation de la table NEEMBA.EQUIPEMENT.GCM_Retour_Donnees_OLGA...
2026-02-26 12:07:48,815 - INFO - üîß G√©n√©ration DDL: AI_GCM_Retour_Donnees_OLGA
2026-02-26 12:07:48,815 - INFO - üìã Extraction du sch√©ma: GCM_Retour_Donnees_OLGA
2026-02-26 12:07:51,646 - INFO - ‚úÖ 24 colonnes extraites
2026-02-26 12:07:51,777 - INFO - ‚úÖ DDL g√©n√©r√© (24 colonnes)
 CREATE OR REPLACE TABLE NEEMBA.EQUIPEMENT.AI_GCM_Retour_Donnees_OLGA (
    Cle_Client NUMBER(10,0) NULL,
    Cle_CLient_Referent NUMBER(10,0) NULL,
    MajorClass_lib VARCHAR(100) NULL,
    MajorClass_code VARCHAR(10) NULL,
    MajorClass_type VARCHAR(10) NULL,
    Cle_RA NUMBER(10,0) NULL,
    Client_DCN_Pere VARCHAR(100) NULL,
    Client_DCN_Fils VARCHAR(100) NULL,
    Chargement_Nom_Fichier VARCHAR(100),
    Date_Annee_Extraction VARCHAR(25),
    Date_Mois_Extraction VARCHAR(2) NULL,
    Date_Mois_Jour NUMBER(10,0) NULL,
    Flag_12R NUMBER(10,0) NULL,
    Date_Debut_Analyse TIMESTAMP_NTZ,
    Date_Fin_Analyse TIMESTAMP_NTZ,
    Labor_Opportunite_Labor_Heures NUMBER(10,0),
    Labor_Ventes_Heures NUMBER(10,0),
    Labor_Opportunite_Montant NUMBER(10,0),
    Labor_Ventes_Montant NUMBER(10,0),
    Parts_Ventes_Montant NUMBER(10,0),
    Parts_Opportunite_Montant NUMBER(10,0) NULL,
    NbMachines NUMBER(10,0),
    Montant_Boost FLOAT,
    Flag_Annee_Mois_Max VARCHAR(1) NULL
)
[32m2026-02-26 12:07:52 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ‚úÖ Table GCM_Retour_Donnees_OLGA cr√©√©e avec succ√®s
[32m2026-02-26 12:07:52 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA -    Localisation: NEEMBA.EQUIPEMENT.GCM_Retour_Donnees_OLGA
[32m2026-02-26 12:07:52 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ================================================================================
[32m2026-02-26 12:07:52 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üì§ Upload vers Snowflake Stage
[32m2026-02-26 12:07:52 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ================================================================================
2026-02-26 12:07:52,497 - INFO - Snowflake Connector for Python Version: 4.3.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-02-26 12:07:52,498 - INFO - Connecting to GLOBAL Snowflake domain
[32m2026-02-26 12:07:55 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üîÑ Upload de mssql_export.csv...
[32m2026-02-26 12:08:04 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ‚úÖ Upload termin√© en 9.31s
[32m2026-02-26 12:08:04 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üìÅ Fichiers dans le stage: 1
[32m2026-02-26 12:08:05 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ================================================================================
[32m2026-02-26 12:08:05 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üì• COPY INTO Snowflake
[32m2026-02-26 12:08:05 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ================================================================================
2026-02-26 12:08:05,109 - INFO - Snowflake Connector for Python Version: 4.3.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-02-26 12:08:05,109 - INFO - Connecting to GLOBAL Snowflake domain
[32m2026-02-26 12:08:08 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üîÑ Chargement dans AI_GCM_Retour_Donnees_OLGA...
[32m2026-02-26 12:08:18 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA -    ‚úì mssql_direct_stage/mssql_export.csv.gz: 937,485 lignes
[32m2026-02-26 12:08:19 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ‚úÖ COPY INTO termin√© en 10.33s
[32m2026-02-26 12:08:19 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üìä‚úÖ Nombre de lignes charg√©es : 937,485
[32m2026-02-26 12:08:19 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üìä‚ùå Nombre d'erreurs : 0
[32m2026-02-26 12:08:19 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üìä Total dans la table AI_GCM_Retour_Donnees_OLGA: 937,485
[32m2026-02-26 12:08:19 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - 
================================================================================
[32m2026-02-26 12:08:19 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ‚úÖ PIPELINE TERMIN√â AVEC SUCC√àS
[32m2026-02-26 12:08:19 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üïí Temps total Snowflake: 237.11s
[32m2026-02-26 12:08:19 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - üìä Total lignes ins√©r√©es: 937,485
[32m2026-02-26 12:08:19 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ‚ö° D√©bit: 3954 rows/sec
[32m2026-02-26 12:08:19 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - GCM_Retour_Donnees_OLGA - ================================================================================

[32m2026-02-26 12:08:19 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - 2504561 - GCM_Retour_Donnees_OLGA - STEP_OUTPUT - Yielded output "result" of type "Any". (Type check passed).
2026-02-26 12:08:19,725 - INFO - Context impl SQLiteImpl.
2026-02-26 12:08:19,726 - INFO - Will assume non-transactional DDL.
[32m2026-02-26 12:08:19 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - 2504561 - GCM_Retour_Donnees_OLGA - ASSET_MATERIALIZATION - Materialized value GCM_Retour_Donnees_OLGA.
[32m2026-02-26 12:08:19 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 998b4da8-10fc-4090-ae75-87333d43a0b4 - 2504561 - GCM_Retour_Donnees_OLGA - STEP_SUCCESS - Finished execution of step "GCM_Retour_Donnees_OLGA" in 3m57s.
