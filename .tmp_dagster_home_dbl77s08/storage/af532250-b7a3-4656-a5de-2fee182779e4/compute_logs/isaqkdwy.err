[32m2026-02-26 12:10:45 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - 2521216 - LOGS_CAPTURED - Started capturing logs in process (pid: 2521216).
[32m2026-02-26 12:10:45 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - 2521216 - V_tiers_dashboard_am - STEP_START - Started execution of step "V_tiers_dashboard_am".
[32m2026-02-26 12:10:45 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - 
================================================================================
[32m2026-02-26 12:10:45 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üöÄ PIPELINE MSSQL ‚Üí SNOWFLAKE
[32m2026-02-26 12:10:45 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üì§‚û°Ô∏è‚ùÑÔ∏è  M√©thode: BCP + COPY INTO
[32m2026-02-26 12:10:45 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ================================================================================

[32m2026-02-26 12:10:45 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ================================================================================
[32m2026-02-26 12:10:45 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üì§ Export BCP depuis SQL Server pour la table V_tiers_dashboard_am
[32m2026-02-26 12:10:45 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ================================================================================
[32m2026-02-26 12:10:45 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üóëÔ∏è  Fichier existant supprim√©: /tmp/mssql_export.csv
2026-02-26 12:10:45,337 - INFO - üîß BCPExporter initialis√©:
2026-02-26 12:10:45,338 - INFO -    Mode: Natif
2026-02-26 12:10:45,338 - INFO -    BCP: bcp
[32m2026-02-26 12:10:45 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üîÑ Ex√©cution BCP...
2026-02-26 12:10:45,363 - INFO - üíª Mode natif
2026-02-26 12:10:45,363 - INFO - üîÑ Commande BCP: bcp SELECT TOP 10000000 * FROM V_tiers_dashboard_am WITH (NOLOCK) queryout /tmp/mssql_export.csv -c -C 65001 -t | -r 
 -S *** -d *** -U *** -P ***
2026-02-26 12:11:25,216 - INFO - ‚úÖ Export BCP r√©ussi: Dur√©e 39.85s, Taille 33.45 MB
[32m2026-02-26 12:11:25 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ‚úÖ Export BCP termin√© en 39.85s
[32m2026-02-26 12:11:25 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am -    Temps BCP: 39.85s
[32m2026-02-26 12:11:25 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am -    Fichier: /tmp/mssql_export.csv
[32m2026-02-26 12:11:25 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am -    Taille: 33.45 MB
[32m2026-02-26 12:11:25 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ================================================================================
[32m2026-02-26 12:11:25 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üîß Setup Snowflake
[32m2026-02-26 12:11:25 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ================================================================================
2026-02-26 12:11:25,326 - INFO - Snowflake Connector for Python Version: 4.3.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-02-26 12:11:25,327 - INFO - Connecting to GLOBAL Snowflake domain
[32m2026-02-26 12:11:28 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üîß Cr√©ation du file format CSV...
[32m2026-02-26 12:11:28 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ‚úÖ File format mssql_csv_file_format cr√©√©
[32m2026-02-26 12:11:28 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üîß Cr√©ation du stage...
[32m2026-02-26 12:11:28 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ‚úÖ Stage MSSQL_DIRECT_STAGE cr√©√©
[32m2026-02-26 12:11:28 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üîß Cr√©ation de la table NEEMBA.EQUIPEMENT.V_tiers_dashboard_am...
2026-02-26 12:11:28,930 - INFO - üîß G√©n√©ration DDL: AI_V_tiers_dashboard_am
2026-02-26 12:11:28,930 - INFO - üìã Extraction du sch√©ma: V_tiers_dashboard_am
2026-02-26 12:11:32,012 - INFO - ‚úÖ 29 colonnes extraites
2026-02-26 12:11:32,095 - INFO - ‚úÖ DDL g√©n√©r√© (29 colonnes)
 CREATE OR REPLACE TABLE NEEMBA.EQUIPEMENT.AI_V_tiers_dashboard_am (
    tier_sk NUMBER(10,0),
    tie_sk NUMBER(10,0) NULL,
    tie_idjade VARCHAR(50),
    date_creation_tier TIMESTAMP_NTZ NULL,
    dra_sk NUMBER(10,0) NULL,
    tie_DCN_Code VARCHAR(10),
    parent_DCN_Code VARCHAR(10),
    tie_idsociete VARCHAR(50),
    tie_idcompagnie VARCHAR(50),
    tie_idirium_ie VARCHAR(50),
    tier_Raison_Sociale VARCHAR(1200),
    tier_cic_Code VARCHAR(80),
    cic_Libelle VARCHAR(100),
    ctci_Code VARCHAR(50),
    NomPSSR_ctci_Code VARCHAR(201),
    Nom_Manager_Commercial_ctci VARCHAR(201),
    tier_CDID VARCHAR(40),
    tier_UCID VARCHAR(50),
    treg_Libelle VARCHAR(100),
    NomPSSR1_ctci VARCHAR(201),
    Nom_Manager_Commercial2 VARCHAR(201),
    tier_dra_code_principal VARCHAR(4),
    dbu_code VARCHAR(10) NULL,
    dbu_libelle_majuscule VARCHAR(50) NULL,
    dra_libelle VARCHAR(50) NULL,
    pay_code VARCHAR(10) NULL,
    pay_libelle VARCHAR(50) NULL,
    pay_libelle_principal VARCHAR(50) NULL,
    tier_lib_nature VARCHAR(30)
)
[32m2026-02-26 12:11:32 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ‚úÖ Table V_tiers_dashboard_am cr√©√©e avec succ√®s
[32m2026-02-26 12:11:32 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am -    Localisation: NEEMBA.EQUIPEMENT.V_tiers_dashboard_am
[32m2026-02-26 12:11:32 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ================================================================================
[32m2026-02-26 12:11:32 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üì§ Upload vers Snowflake Stage
[32m2026-02-26 12:11:32 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ================================================================================
2026-02-26 12:11:32,908 - INFO - Snowflake Connector for Python Version: 4.3.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-02-26 12:11:32,908 - INFO - Connecting to GLOBAL Snowflake domain
[32m2026-02-26 12:11:35 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üîÑ Upload de mssql_export.csv...
[32m2026-02-26 12:11:38 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ‚úÖ Upload termin√© en 3.03s
[32m2026-02-26 12:11:38 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üìÅ Fichiers dans le stage: 1
[32m2026-02-26 12:11:39 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ================================================================================
[32m2026-02-26 12:11:39 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üì• COPY INTO Snowflake
[32m2026-02-26 12:11:39 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ================================================================================
2026-02-26 12:11:39,148 - INFO - Snowflake Connector for Python Version: 4.3.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-02-26 12:11:39,148 - INFO - Connecting to GLOBAL Snowflake domain
[32m2026-02-26 12:11:41 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üîÑ Chargement dans AI_V_tiers_dashboard_am...
[32m2026-02-26 12:11:46 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am -    ‚úì mssql_direct_stage/mssql_export.csv.gz: 145,544 lignes
[32m2026-02-26 12:11:46 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ‚úÖ COPY INTO termin√© en 4.35s
[32m2026-02-26 12:11:46 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üìä‚úÖ Nombre de lignes charg√©es : 145,544
[32m2026-02-26 12:11:46 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üìä‚ùå Nombre d'erreurs : 0
[32m2026-02-26 12:11:46 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üìä Total dans la table AI_V_tiers_dashboard_am: 145,544
[32m2026-02-26 12:11:46 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - 
================================================================================
[32m2026-02-26 12:11:46 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ‚úÖ PIPELINE TERMIN√â AVEC SUCC√àS
[32m2026-02-26 12:11:47 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üïí Temps total Snowflake: 61.87s
[32m2026-02-26 12:11:47 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - üìä Total lignes ins√©r√©es: 145,544
[32m2026-02-26 12:11:47 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ‚ö° D√©bit: 2353 rows/sec
[32m2026-02-26 12:11:47 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - V_tiers_dashboard_am - ================================================================================

[32m2026-02-26 12:11:47 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - 2521216 - V_tiers_dashboard_am - STEP_OUTPUT - Yielded output "result" of type "Any". (Type check passed).
2026-02-26 12:11:47,224 - INFO - Context impl SQLiteImpl.
2026-02-26 12:11:47,226 - INFO - Will assume non-transactional DDL.
[32m2026-02-26 12:11:47 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - 2521216 - V_tiers_dashboard_am - ASSET_MATERIALIZATION - Materialized value V_tiers_dashboard_am.
[32m2026-02-26 12:11:47 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - af532250-b7a3-4656-a5de-2fee182779e4 - 2521216 - V_tiers_dashboard_am - STEP_SUCCESS - Finished execution of step "V_tiers_dashboard_am" in 1m2s.
