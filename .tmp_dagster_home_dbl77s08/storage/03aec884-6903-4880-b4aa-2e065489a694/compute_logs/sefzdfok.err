[32m2026-02-26 11:57:26 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - 2486734 - LOGS_CAPTURED - Started capturing logs in process (pid: 2486734).
[32m2026-02-26 11:57:26 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - 2486734 - GCM_Retour_Donnees_OLGA - STEP_START - Started execution of step "GCM_Retour_Donnees_OLGA".
[32m2026-02-26 11:57:26 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - 
================================================================================
[32m2026-02-26 11:57:26 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - üöÄ PIPELINE MSSQL ‚Üí SNOWFLAKE
[32m2026-02-26 11:57:26 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - üì§‚û°Ô∏è‚ùÑÔ∏è  M√©thode: BCP + COPY INTO
[32m2026-02-26 11:57:26 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - ================================================================================

[32m2026-02-26 11:57:26 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - ================================================================================
[32m2026-02-26 11:57:26 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - üì§ Export BCP depuis SQL Server pour la table GCM_Retour_Donnees_OLGA
[32m2026-02-26 11:57:26 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - ================================================================================
[32m2026-02-26 11:57:26 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - üóëÔ∏è  Fichier existant supprim√©: /tmp/mssql_export.csv
2026-02-26 11:57:26,587 - INFO - üîß BCPExporter initialis√©:
2026-02-26 11:57:26,587 - INFO -    Mode: Natif
2026-02-26 11:57:26,587 - INFO -    BCP: bcp
[32m2026-02-26 11:57:26 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - üîÑ Ex√©cution BCP...
2026-02-26 11:57:26,611 - INFO - üíª Mode natif
2026-02-26 11:57:26,612 - INFO - üîÑ Commande BCP: bcp SELECT TOP 10000000 * FROM GCM_Retour_Donnees_OLGA WITH (NOLOCK) queryout /tmp/mssql_export.csv -c -C 65001 -t | -r 
 -S *** -d *** -U *** -P ***
2026-02-26 12:00:44,325 - INFO - ‚úÖ Export BCP r√©ussi: Dur√©e 197.71s, Taille 152.52 MB
[32m2026-02-26 12:00:44 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - ‚úÖ Export BCP termin√© en 197.71s
[32m2026-02-26 12:00:44 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA -    Temps BCP: 197.71s
[32m2026-02-26 12:00:44 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA -    Fichier: /tmp/mssql_export.csv
[32m2026-02-26 12:00:44 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA -    Taille: 152.52 MB
[32m2026-02-26 12:00:44 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - ================================================================================
[32m2026-02-26 12:00:44 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - üîß Setup Snowflake
[32m2026-02-26 12:00:44 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - ================================================================================
2026-02-26 12:00:44,429 - INFO - Snowflake Connector for Python Version: 4.3.0, Python Version: 3.12.3, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-02-26 12:00:44,429 - INFO - Connecting to GLOBAL Snowflake domain
[32m2026-02-26 12:00:47 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - üîß Cr√©ation du file format CSV...
[32m2026-02-26 12:00:48 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - ‚úÖ File format mssql_csv_file_format cr√©√©
[32m2026-02-26 12:00:48 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - üîß Cr√©ation du stage...
[32m2026-02-26 12:00:48 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - ‚úÖ Stage MSSQL_DIRECT_STAGE cr√©√©
[32m2026-02-26 12:00:48 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - üîß Cr√©ation de la table NEEMBA.EQUIPEMENT.GCM_Retour_Donnees_OLGA...
2026-02-26 12:00:48,515 - INFO - üîß G√©n√©ration DDL: AI_GCM_Retour_Donnees_OLGA
2026-02-26 12:00:48,515 - INFO - üìã Extraction du sch√©ma: GCM_Retour_Donnees_OLGA
2026-02-26 12:00:50,975 - INFO - ‚úÖ 24 colonnes extraites
2026-02-26 12:00:51,051 - INFO - ‚úÖ DDL g√©n√©r√© (24 colonnes)
 CREATE OR REPLACE TABLE NEEMBA.EQUIPEMENT.AI_GCM_Retour_Donnees_OLGA (
    Cle_Client NUMBER(10,0) NULL,
    Cle_CLient_R√©f√©rent NUMBER(10,0) NULL,
    MajorClass_lib VARCHAR(100) NULL,
    MajorClass_code VARCHAR(10) NULL,
    MajorClass_type VARCHAR(10) NULL,
    Cle_RA NUMBER(10,0) NULL,
    Client_DCN_P√®re VARCHAR(100) NULL,
    Client_DCN_Fils VARCHAR(100) NULL,
    Chargement_Nom_Fichier VARCHAR(100),
    Date_Ann√©e_Extraction VARCHAR(25),
    Date_Mois_Extraction VARCHAR(2) NULL,
    Date_Mois_Jour NUMBER(10,0) NULL,
    Flag_12R NUMBER(10,0) NULL,
    Date_D√©but_Analyse TIMESTAMP_NTZ,
    Date_Fin_Analyse TIMESTAMP_NTZ,
    Labor_Opportunit√©_Labor_Heures NUMBER(10,0),
    Labor_Ventes_Heures NUMBER(10,0),
    Labor_Opportunit√©_Montant NUMBER(10,0),
    Labor_Ventes_Montant NUMBER(10,0),
    Parts_Ventes_Montant NUMBER(10,0),
    Parts_Opportunit√©_Montant NUMBER(10,0) NULL,
    NbMachines NUMBER(10,0),
    Montant_Boost FLOAT,
    Flag_Ann√©e_Mois_Max VARCHAR(1) NULL
)
[32m2026-02-26 12:00:51 +0000[0m - dagster - [34mERROR[0m - [31m__ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - GCM_Retour_Donnees_OLGA - 
‚ùå ERREUR PIPELINE: 001003 (42000): 01c2ab90-0209-4e95-0002-f322008f5dfa: SQL compilation error:
syntax error line 3 at position 16 unexpected '√©f'.
syntax error line 3 at position 34 unexpected '0'.
syntax error line 3 at position 37 unexpected 'NULL'.[0m
[32m2026-02-26 12:00:51 +0000[0m - dagster - [34mERROR[0m - [31m__ASSET_JOB - 03aec884-6903-4880-b4aa-2e065489a694 - 2486734 - GCM_Retour_Donnees_OLGA - STEP_FAILURE - Execution of step "GCM_Retour_Donnees_OLGA" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "GCM_Retour_Donnees_OLGA"::

snowflake.connector.errors.ProgrammingError: 001003 (42000): 01c2ab90-0209-4e95-0002-f322008f5dfa: SQL compilation error:
syntax error line 3 at position 16 unexpected '√©f'.
syntax error line 3 at position 34 unexpected '0'.
syntax error line 3 at position 37 unexpected 'NULL'.

Stack Trace:
  File "/home/sarrj/project_jgs/mssql_data_nmbai/.venv/lib/python3.12/site-packages/dagster/_core/execution/plan/utils.py", line 57, in op_execution_error_boundary
    yield
  File "/home/sarrj/project_jgs/mssql_data_nmbai/.venv/lib/python3.12/site-packages/dagster/_utils/__init__.py", line 394, in iterate_with_context
    next_output = next(iterator)
                  ^^^^^^^^^^^^^^
  File "/home/sarrj/project_jgs/mssql_data_nmbai/.venv/lib/python3.12/site-packages/dagster/_core/execution/plan/compute_generator.py", line 135, in _coerce_op_compute_fn_to_iterator
    result = invoke_compute_fn(
             ^^^^^^^^^^^^^^^^^^
  File "/home/sarrj/project_jgs/mssql_data_nmbai/.venv/lib/python3.12/site-packages/dagster/_core/execution/plan/compute_generator.py", line 115, in invoke_compute_fn
    return fn(context, **args_to_pass) if context_arg_provided else fn(**args_to_pass)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sarrj/project_jgs/mssql_data_nmbai/src/mssql_data_nmbai/defs/assets.py", line 116, in gcm_retour_donnees_olga_assets
    result = extract_mssql_data(
             ^^^^^^^^^^^^^^^^^^^
  File "/home/sarrj/project_jgs/mssql_data_nmbai/src/mssql_data_nmbai/defs/load_bcp_copy_into.py", line 45, in extract_mssql_data
    setup_snowflake(mssql_table_name = mssql_table_name,
  File "/home/sarrj/project_jgs/mssql_data_nmbai/src/mssql_data_nmbai/defs/snowflake_dest.py", line 134, in setup_snowflake
    create_snowflake_table(
  File "/home/sarrj/project_jgs/mssql_data_nmbai/src/mssql_data_nmbai/defs/snowflake_dest.py", line 112, in create_snowflake_table
    cursor.execute(sql_ddl)
  File "/home/sarrj/project_jgs/mssql_data_nmbai/.venv/lib/python3.12/site-packages/snowflake/connector/cursor.py", line 1144, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "/home/sarrj/project_jgs/mssql_data_nmbai/.venv/lib/python3.12/site-packages/snowflake/connector/errors.py", line 298, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sarrj/project_jgs/mssql_data_nmbai/.venv/lib/python3.12/site-packages/snowflake/connector/errors.py", line 354, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/sarrj/project_jgs/mssql_data_nmbai/.venv/lib/python3.12/site-packages/snowflake/connector/errors.py", line 229, in default_errorhandler
    raise error_class(
[0m
